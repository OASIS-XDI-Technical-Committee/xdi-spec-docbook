<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>XDI Signatures V1.0</title><link rel="stylesheet" href="file:/Users/pdavis/projects/SDO/oasis/XDI-TC/XDI-1.0/xdi-spec-docbook/htmlruntime/spec-0.6/css/oasis-spec.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.69.1"><meta name="description" content="Abstract This Working Draft 01 specifies methods to create and validate cryptographic signatures for&#xA;          XDI statements, subgraphs and protocol&#xA;        messages."><meta name="cvsinfo" content="Id: oasis-specification-0.6-wd04.xml,v 1.2 2012/06/14 01:57:23 admin&#xA;      Exp "></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="article" lang="en"><div class="titlepage"><div><p class="logo"><a href="http://www.oasis-open.org/"><img src="file:/Users/pdavis/projects/SDO/oasis/XDI-TC/XDI-1.0/xdi-spec-docbook/htmlruntime/spec-0.6/OASISLogo.jpg" alt="OASIS" border="0"></a></p><div><hr style="margin-bottom:0pt"><h1 class="title"><a name="d0e4"></a>XDI Signatures V1.0</h1></div><div><h2>Working Draft 01</h2><h2>23 May 2014</h2></div><div></div><div><!--  $Id: oasis-specification-0.6-wd04.xml,v 1.2 2012/06/14 01:57:23 admin
      Exp $  --></div><div><dl><dt><span class="uri-heading">
          Specification URIs
        </span></dt></dl><dl><dt><span class="loc-heading">This version:</span></dt><dd><a href="http://docs.oasis-open.org/templates/DocBook/spec-1.0/xdi-signatures-1.0-wd01.html">http://docs.oasis-open.org/templates/DocBook/spec-1.0/xdi-signatures-1.0-wd01.html</a>
                  (Authoritative)
                <br><a href="http://docs.oasis-open.org/templates/DocBook/spec-1.0/xdi-signatures-1.0-wd01.pdf">http://docs.oasis-open.org/templates/DocBook/spec-1.0/xdi-signatures-1.0-wd01.pdf</a><br><a href="http://docs.oasis-open.org/templates/DocBook/spec-1.0/xdi-signatures-1.0-wd01.xml">http://docs.oasis-open.org/templates/DocBook/spec-1.0/xdi-signatures-1.0-wd01.xml</a><br></dd></dl><dl><dt><span class="loc-heading">Previous version:</span></dt><dd><a href="http://docs.oasis-open.org/templates/DocBook/spec-0.0/xdi-signatures-0.0.html">http://docs.oasis-open.org/templates/DocBook/spec-0.0/xdi-signatures-0.0.html</a>
                  (Authoritative)
                <br><a href="http://docs.oasis-open.org/templates/DocBook/spec-0.0/xdi-signatures-0.0.pdf">http://docs.oasis-open.org/templates/DocBook/spec-0.0/xdi-signatures-0.0.pdf</a><br><a href="http://docs.oasis-open.org/templates/DocBook/spec-0.0/xdi-signatures-0.0.xml">http://docs.oasis-open.org/templates/DocBook/spec-0.0/xdi-signatures-0.0.xml</a><br></dd></dl><dl><dt><span class="loc-heading">Latest version:</span></dt><dd><a href="http://docs.oasis-open.org/templates/DocBook/oasis-specification/xdi-signatures.html">http://docs.oasis-open.org/templates/DocBook/oasis-specification/xdi-signatures.html</a>
                  (Authoritative)
                <br><a href="http://docs.oasis-open.org/templates/DocBook/oasis-specification/xdi-signatures.pdf">http://docs.oasis-open.org/templates/DocBook/oasis-specification/xdi-signatures.pdf</a><br><a href="http://docs.oasis-open.org/templates/DocBook/oasis-specification/xdi-signatures.xml">http://docs.oasis-open.org/templates/DocBook/oasis-specification/xdi-signatures.xml</a><br></dd></dl></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div><dl><dt><span class="loc-heading">Technical Committee:</span></dt><dd><a href="https://www.oasis-open.org/apps/org/workgroup/xdi/" target="_top">OASIS XRI Data Interchange (XDI) TC</a></dd></dl></div><div><dl><dt><span class="editor-heading">Editors:</span></dt><dd><span class="firstname">Peter</span> <span class="surname">Davis</span> (<a href="mailto:peter.davis@neustar.biz">peter.davis@neustar.biz</a>), Neustar, Inc.<br><span class="firstname">Dan</span> <span class="surname">Blum</span>, Respect Network Corp.</dd></dl></div><div><dl><dt><a name="d0e82"></a><span class="status-heading">Additional artifacts:</span></dt><dd><p>This Working Draft 01 is part of a broader suite of specifications collectively referred to as
        XDI 1.0. The following specifications constitute the complete suite: </p><div class="itemizedlist"><ul type="disc"><li><p>XDI Core [<a href="#XDICore" title="[XDICore]"><b><span class="abbrev">XDICore</span></b></a>]</p></li><li><p>XDI Messaging [<a href="#XDIMsg" title="[XDIMsg]"><b><span class="abbrev">XDIMsg</span></b></a>]</p></li><li><p>XDI Discovery [<a href="#XDIDisco" title="[XDIDisco]"><b><span class="abbrev">XDIDisco</span></b></a>]</p></li><li><p>XDI Policy [<a href="#XDIPolicy" title="[XDIPolicy]"><b><span class="abbrev">XDIPolicy</span></b></a>]</p></li><li><p>XDI Security Mechanisms [<a href="#XDISec" title="[XDISec]"><b><span class="abbrev">XDISec</span></b></a>]</p></li><li><p>XDI Privacy [<a href="#XDIPriv" title="[XDIPriv]"><b><span class="abbrev">XDIPriv</span></b></a>]</p></li><li><p>XDI Dictionary [<a href="#XDIDictionary" title="[XDIDictionary]"><b><span class="abbrev">XDIDictionary</span></b></a>]</p></li><li><p>XDI Signature [<a href="#XDISig" title="[XDISig]"><b><span class="abbrev">XDISig</span></b></a>]</p></li></ul></div><p>
      </p></dd></dl></div><div><dl><dt><a name="d0e122"></a><span class="abstract-heading">Abstract:</span></dt><dd><p>This Working Draft 01 specifies methods to create and validate cryptographic signatures for
          <a href="#g.xdi"><em class="glossterm">XDI</em></a> statements, subgraphs and protocol
        messages.</p></dd></dl></div><div><hr><h2 class="notices-heading">Notices</h2><p>Copyright &copy; OASIS&reg; Open 2012. All Rights Reserved. </p><p>All capitalized terms in the following text have the meanings assigned to them in the
        OASIS Intellectual Property Rights Policy (the "OASIS IPR Policy"). The full Policy may be
        found at <a href="http://www.oasis-open.org/who/intellectualproperty.php" target="_top">http://www.oasis-open.org/who/intellectualproperty.php</a>.</p><p>This document and translations of it may be copied and furnished to others, and
        derivative works that comment on or otherwise explain it or assist in its implementation may
        be prepared, copied, published, and distributed, in whole or in part, without restriction of
        any kind, provided that the above copyright notice and this section are included on all such
        copies and derivative works. However, this document itself may not be modified in any way,
        including by removing the copyright notice or references to OASIS, except as needed for the
        purpose of developing any document or deliverable produced by an OASIS Technical Committee
        (in which case the rules applicable to copyrights, as set forth in the OASIS IPR Policy,
        must be followed) or as required to translate it into languages other than English.</p><p>The limited permissions granted above are perpetual and will not be revoked by OASIS or
        its successors or assigns.</p><p>This document and the information contained herein is provided on an "AS IS" basis and
        OASIS DISCLAIMS ALL WARRANTIES, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY
        WARRANTY THAT THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY OWNERSHIP RIGHTS OR
        ANY IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.</p><p>OASIS requests that any OASIS Party or any other party that believes it has patent
        claims that would necessarily be infringed by implementations of this OASIS Committee
        Specification or OASIS Standard, to notify OASIS TC Administrator and provide an indication
        of its willingness to grant patent licenses to such patent claims in a manner consistent
        with the IPR Mode of the OASIS Technical Committee that produced this specification.</p><p>OASIS invites any party to contact the OASIS TC Administrator if it is aware of a claim
        of ownership of any patent claims that would necessarily be infringed by implementations of
        this specification by a patent holder that is not willing to provide a license to such
        patent claims in a manner consistent with the IPR Mode of the OASIS Technical Committee that
        produced this specification. OASIS may include such claims on its website, but disclaims any
        obligation to do so.</p><p>OASIS takes no position regarding the validity or scope of any intellectual property or
        other rights that might be claimed to pertain to the implementation or use of the technology
        described in this document or the extent to which any license under such rights might or
        might not be available; neither does it represent that it has made any effort to identify
        any such rights. Information on OASIS' procedures with respect to rights in any document or
        deliverable produced by an OASIS Technical Committee can be found on the OASIS website.
        Copies of claims of rights made available for publication and any assurances of licenses to
        be made available, or the result of an attempt made to obtain a general license or
        permission for the use of such proprietary rights by implementers or users of this OASIS
        Committee Specification or OASIS Standard, can be obtained from the OASIS TC Administrator.
        OASIS makes no representation that any information or list of intellectual property rights
        will at any time be complete, or that any claims in such list are, in fact, Essential
        Claims.</p><p>The name "OASIS" is a trademark of <a href="http://www.oasis-open.org" target="_top">OASIS</a>,
        the owner and developer of this specification, and should be used only to refer to the
        organization and its official outputs. OASIS welcomes reference to, and implementation and
        use of, specifications, while reserving the right to enforce its marks against misleading
        uses. Please see <a href="http://www.oasis-open.org/who/trademark.php" target="_top">http://www.oasis-open.org/who/trademark.php</a> for above guidance.</p></div></div><hr></div><div class="toc"><h2>Table of Contents</h2><dl><dt><span class="section"><a href="#s.intro">1 Introduction</a></span></dt><dd><dl><dt><span class="section"><a href="#d0e169">1.1 Related Publications</a></span></dt><dt><span class="section"><a href="#d0e208">1.2 Terminology and Notation Conventions</a></span></dt><dd><dl><dt><span class="section"><a href="#d0e211">1.2.1 Key words</a></span></dt><dt><span class="section"><a href="#s.glossary">1.2.2 Glossary of Terms</a></span></dt><dt><span class="section"><a href="#d0e284">1.2.3 Document Convensions</a></span></dt></dl></dd><dt><span class="section"><a href="#s.design">1.3 Design Requirements</a></span></dt></dl></dd><dt><span class="section"><a href="#s.usage">2 Usage</a></span></dt><dt><span class="section"><a href="#s.cryptmeta">3 Cryptography Metadata</a></span></dt><dd><dl><dt><span class="section"><a href="#s.keymeta">3.1 Key Metadata</a></span></dt><dd><dl><dt><span class="section"><a href="#d.key">3.1.1 $key Reserved Dictionary Term</a></span></dt><dt><span class="section"><a href="#d.x509">3.1.2 $x509 Reserved Dictionary Term</a></span></dt><dt><span class="section"><a href="#d.keyencode">3.1.3 Key Encoding Reserved Dictionary Terms</a></span></dt></dl></dd><dt><span class="section"><a href="#s.sigmeta">3.2 Signature Metadata</a></span></dt><dd><dl><dt><span class="section"><a href="#d0e449">3.2.1 Signature Algorithm</a></span></dt><dt><span class="section"><a href="#d0e462">3.2.2 Canonicalization Method</a></span></dt><dt><span class="section"><a href="#d0e466">3.2.3 Digest Method</a></span></dt></dl></dd><dt><span class="section"><a href="#s.encmeta">3.3 Encryption Metadata</a></span></dt><dd><dl><dt><span class="section"><a href="#d.encrypted">3.3.1 $encrypted Reserved Dictionary Term</a></span></dt><dt><span class="section"><a href="#d.mime">3.3.2 $mime Reserved Dictionary Term</a></span></dt><dt><span class="section"><a href="#d0e489">3.3.3 MimeType</a></span></dt><dt><span class="section"><a href="#d0e493">3.3.4 Encoding</a></span></dt><dt><span class="section"><a href="#d0e497">3.3.5 EncyptionMethod</a></span></dt><dt><span class="section"><a href="#d0e501">3.3.6 CypherText</a></span></dt></dl></dd></dl></dd><dt><span class="section"><a href="#s.sigproccess">4 XDI Signatures</a></span></dt><dd><dl><dt><span class="section"><a href="#d0e524">4.1 Signature Processing Rules</a></span></dt><dt><span class="section"><a href="#d0e528">4.2 Canonical Representation</a></span></dt><dd><dl><dt><span class="section"><a href="#d0e540">4.2.1 Canonicalization Process</a></span></dt></dl></dd><dt><span class="section"><a href="#s.alg">4.3 Algorithms</a></span></dt><dt><span class="section"><a href="#d0e571">4.4 Graph Signatures</a></span></dt><dt><span class="section"><a href="#d0e575">4.5 Message Signatures</a></span></dt></dl></dd><dt><span class="section"><a href="#s.encprocess">5 Encryption Processing Rules</a></span></dt><dt><span class="section"><a href="#s.seccon">6 Security Considerations</a></span></dt><dt><span class="section"><a href="#s.biblio">7 Normative References</a></span></dt></dl><h3>Appendixes</h3><dl><dt><span class="appendix"><a href="#s.examples">A Examples</a></span></dt><dd><dl><dt><span class="section"><a href="#d0e1007">A.1 Graph Signature Examples</a></span></dt><dt><span class="section"><a href="#d0e1011">A.2 Message Signature Examples</a></span></dt></dl></dd><dt><span class="appendix"><a href="#s.revhist">B Revision History</a></span></dt></dl></div><hr><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="s.intro"></a>1 Introduction</h2></div></div></div><p>Signatures for XDI can be applied to individual statements (triples), subgraphs and XDI
      protocol messages. XDI Security Mechanisms [<a href="#XDISec" title="[XDISec]"><b><span class="abbrev">XDISec</span></b></a>] requires that XDI messages
      should incorporate methods to authenticate message originators, as well as methods to ensure
      message integrity. XDI Signatures provides one such method. </p><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e169"></a>1.1 Related Publications</h3></div></div></div><p>This Working Draft 01 is part of a broader suite of specifications collectively referred to as
        XDI 1.0. The following specifications constitute the complete suite: </p><div class="itemizedlist"><ul type="disc"><li><p>XDI Core [<a href="#XDICore" title="[XDICore]"><b><span class="abbrev">XDICore</span></b></a>]</p></li><li><p>XDI Messaging [<a href="#XDIMsg" title="[XDIMsg]"><b><span class="abbrev">XDIMsg</span></b></a>]</p></li><li><p>XDI Discovery [<a href="#XDIDisco" title="[XDIDisco]"><b><span class="abbrev">XDIDisco</span></b></a>]</p></li><li><p>XDI Policy [<a href="#XDIPolicy" title="[XDIPolicy]"><b><span class="abbrev">XDIPolicy</span></b></a>]</p></li><li><p>XDI Security Mechanisms [<a href="#XDISec" title="[XDISec]"><b><span class="abbrev">XDISec</span></b></a>]</p></li><li><p>XDI Privacy [<a href="#XDIPriv" title="[XDIPriv]"><b><span class="abbrev">XDIPriv</span></b></a>]</p></li><li><p>XDI Dictionary [<a href="#XDIDictionary" title="[XDIDictionary]"><b><span class="abbrev">XDIDictionary</span></b></a>]</p></li><li><p>XDI Signature [<a href="#XDISig" title="[XDISig]"><b><span class="abbrev">XDISig</span></b></a>]</p></li></ul></div><p>
      </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e208"></a>1.2 Terminology and Notation Conventions</h3></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e211"></a>1.2.1 Key words</h4></div></div></div><p>The key words <em class="glossterm">MUST</em>, <em class="glossterm">MUST NOT</em>,
        <em class="glossterm">REQUIRED</em>, <em class="glossterm">SHALL</em>, <em class="glossterm">SHALL
            NOT</em>, <em class="glossterm">SHOULD</em>, <em class="glossterm">SHOULD NOT</em>,
        <em class="glossterm">RECOMMENDED</em>, <em class="glossterm">MAY</em>, and
        <em class="glossterm">OPTIONAL</em> are to be interpreted as described in [<a href="#rfc2119" title="[RFC 2119]"><b><span class="abbrev">RFC 2119</span></b></a>].</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="s.glossary"></a>1.2.2 Glossary of Terms</h4></div></div></div><p>
        </p><div class="glosslist"><dl><dt><a name="g.xdi"></a>XDI</dt><dd><p>XRI Data Interchange</p></dd><dt>Normalized Graph</dt><dd><p>the canonical form of the graph, necessary to ensure successful signature validation.</p></dd><dt>Signature Block</dt><dd><p>a collection of XDI statements describing metadata about the signature sufficient to ensure successful validation, and the signature itself.</p></dd><dt>XDI Flat Serialization</dt><dd><p>Serialization of an XDI graph in JSON format [<a href="#RFC7159" title="[RFC7159]"><b><span class="abbrev">RFC7159</span></b></a>]using a key-value structure</p></dd></dl></div><p>
    </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e284"></a>1.2.3 Document Convensions</h4></div></div></div><p>Terms defined to have a specific meaning within this specification will be capitalized,
        for example, &#8220;Normalized Graph&#8221;, and should be interpreted with their general meaning if not
        capitalized. Normative key words are written in all caps, for example, &#8220;SHALL&#8221;.</p><p><a name="test"></a>
        XDI notations use the XDI Single Line Display format as defined in [<a href="#XDICore" title="[XDICore]"><b><span class="abbrev">XDICore</span></b></a>]. In some cases, other serializations may be used, in which case, the serialization form used will be indicated. Multiple statements will appear as follows:
        </p><pre class="programlisting">([=]!1111)/$ref/
=example&lt;#name&gt;&amp;/&amp;/"Example Subject"
=example&lt;#email&gt;&amp;/&amp;/"subject@example.org"
=example/#friend/=alice
=example/#friend/=bob
/$is$ref/([=]!1111)</pre><p>
        Inidividual statements may be used inline, in which case they will appear in fixed width Serif: <code class="code">=example&lt;#name&gt;&amp;/&amp;/"Example Subject"</code>.
    </p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="s.design"></a>1.3 Design Requirements</h3></div></div></div><p>
        <span class="bold"><strong>Requirements for signatures:</strong></span>
        </p><div class="orderedlist"><ol type="1"><li><p>A graph must be able to describe specific charateristics of cryptograph material
              netadata.</p></li><li><p>A graph subject must be able to sign specific subgraphs. (e.g.
                <code class="code">(=example/#friend)</code>).</p></li><li><p>A graph subject signs a specific triple found in her graph (e.g.
                <code class="code">=example&lt;#email&gt;&amp;/&amp;/"me@example.com"</code>).</p></li><li><p>A third party creates a signature over a subgraph (or single triple) to place in
              another entities graph (e.g.
                <code class="code">=example&lt;#email&gt;&lt;#work&gt;&amp;/&amp;/"person@example.org"</code> signed by
                <code class="code">@example</code>).</p></li><li><p>Determine what is (and is not) signed in a specific graph by direct analysis of
              the signature triple.</p></li><li><p>Ability to validate a signature made by the graph subject or a third party</p></li></ol></div><p>
        <span class="bold"><strong>Requirements for encryption: </strong></span></p><div class="orderedlist"><ol type="1"><li><p>it must be possible to encrypt literals in the graph</p></li><li><p>it must be possible to encrypt a single statement in the graph</p></li><li><p>it must be possible to encrypt sub graphs in the graph</p></li><li><p>methods must be provided to address statements and sub graphs that are
              encrypted</p></li><li><p>it must be possible to signal when encrypted data must be stored in its' encrypted
              form (or not)</p></li></ol></div><p>
      </p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="s.usage"></a>2 Usage</h2></div></div></div><p>[<a href="#XDISec" title="[XDISec]"><b><span class="abbrev">XDISec</span></b></a>] recommends that XDI messages should incorporate mechanisms for
      confidentiality, integrity and authenticity. This specification defines the manner in which
      cryptograph material, including certain metadata, can be included in a graph. It also defines
      methods for establishing signatures for XDI messages, the syntax for expressing these
      signatures as a sequence of triples suitable for storage in a graph. Lastly, it specifies
      methods for encrypting literals, triples, subgraphs and whole messages.</p><p>Since both encryption and signatures require cryptographic key material (semetric or
      asymetric), certain characteristics of the key material must be described. This metadata is
      defined in <a href="#s.keymeta" title="3.1 Key Metadata">Section 3.1, &#8220;Key Metadata&#8221;</a>.</p><p>XDI Signatures consist of several characteristics: Algorythm information, Hashing
      information, and The signature itself. Processing instructions for the creation and validation
      of XDI signatures are provided in section <a href="#s.sigproccess" title="4 XDI Signatures">Section 4, &#8220;XDI Signatures&#8221;</a>. </p><p>There are several applications for XDI signatures. For XDI messages, they may be used to
      fufill the requirements in [<a href="#XDISec" title="[XDISec]"><b><span class="abbrev">XDISec</span></b></a>] for message integrity and authenticity.
      For graph representations, signatures can indicate that the signer is asserting specific
      statements in the graph (for example, the graph subject is asserting a list of friends
      addressed by the inner root (<code class="code">=example/#friend</code>) ). Signatures can also be placed
      in a third parties graph, indicating that the signer is asserting one or more statements about
      the graph subject (e.g. a subject's emlployer asserts the work email address of the
      subject).</p><p>The encryption mechanisms defined in this document are ssufficient to fullfill the
      confidentiality requirements defined in [<a href="#XDISec" title="[XDISec]"><b><span class="abbrev">XDISec</span></b></a>]. The mecahnics of encrypting
      information in the graph, as well as the neccesary encryption metadata are defined in <a href="#s.encprocess" title="5 Encryption Processing Rules">Section 5, &#8220;Encryption Processing Rules&#8221;</a></p><p>???</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="s.cryptmeta"></a>3 Cryptography Metadata</h2></div></div></div><p>Performing cryptographic operations on graphs, subgraphs and messages requires message
      recipients to posses select information about the algorythms and keys in order to reverse or
      reproduce the operations. The metadata defined in this section is also incorporated in [<a href="#XDIDictionary" title="[XDIDictionary]"><b><span class="abbrev">XDIDictionary</span></b></a>] for reference.</p><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="s.keymeta"></a>3.1 Key Metadata</h3></div></div></div><p>Key material expressed in a graph require descirptive charateristics of the key for
        proper application of cryptographic operations. The following dictionary terms are used to
        describe symetric and asymetric keys.</p><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d.key"></a>3.1.1 $key Reserved Dictionary Term</h4></div></div></div><p>The <code class="code">$key</code> reserved term is used to declare a literal is a cryptographic
        key.</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d.x509"></a>3.1.2 $x509 Reserved Dictionary Term</h4></div></div></div><p>The <code class="code">$x509</code> term indicates that the corresponding literal is either a URL
        refering to a PEM or DER encoded x509 certificate, or that the PEM or DER encoded
        certificate is included in the subject graph.</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d.keyencode"></a>3.1.3 Key Encoding Reserved Dictionary Terms</h4></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h5 class="title"><a name="d0e418"></a>3.1.3.1 $pem Reserved Dictionary Term</h5></div></div></div><p>The <code class="code">$pem</code> term indicates a key located in the graph is PEM encoded ???.</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h5 class="title"><a name="d0e428"></a>3.1.3.2 $der Key Encoding</h5></div></div></div><p>The <code class="code">$der</code> term indicates a key located in the graph is DER encoded ???.</p></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="s.sigmeta"></a>3.2 Signature Metadata</h3></div></div></div><p>To construct the <em class="glossterm">Signature Block</em>, the following statements MUST
        be added to the <em class="glossterm">Normalized Graph</em>: </p><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e449"></a>3.2.1 Signature Algorithm</h4></div></div></div><p>The Algorithm <em class="glossterm">Signature Block</em> statement identifies the
          cryptographic algorithm used to secure the signature.</p><div class="example"><a name="e.alg"></a><p class="title"><i>Example 1. Signature Algorithm Example</i></p><pre class="programlisting"></pre><p></p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e462"></a>3.2.2 Canonicalization Method</h4></div></div></div><p></p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e466"></a>3.2.3 Digest Method</h4></div></div></div><p></p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="s.encmeta"></a>3.3 Encryption Metadata</h3></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d.encrypted"></a>3.3.1 $encrypted Reserved Dictionary Term</h4></div></div></div><p>The <code class="code">$encrypted</code> reserver term indicates that the referenced literal, sub graph or sub graph has been encrypted. Key metadata discussed in <a href="#s.keymeta" title="3.1 Key Metadata">Section 3.1, &#8220;Key Metadata&#8221;</a> provides additional information about key metadata and encryption metadata.</p></div><p></p><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d.mime"></a>3.3.2 $mime Reserved Dictionary Term</h4></div></div></div><p>The $mime term is a requied property when encrypting literals in XDI messages. $mime is used to inform a message recipient the type of media that has been encrpyted (for example, image/png). Valid values for the $mime term as described in [rfc????] and as registered with [IANA]. Use of proprietary mime types is discoraged, as this may result in message recipients in ability to process the message completely. Clients which do not support the stated media type MUST NOT decrypt the value of a literal.</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e489"></a>3.3.3 MimeType</h4></div></div></div><p></p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e493"></a>3.3.4 Encoding</h4></div></div></div><p></p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e497"></a>3.3.5 EncyptionMethod</h4></div></div></div><p></p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e501"></a>3.3.6 CypherText</h4></div></div></div><p></p></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="s.sigproccess"></a>4 XDI Signatures</h2></div></div></div><p>Notes:</p><p>signatures that require SHA-256 [<a href="#SHA" title="[SHA]"><b><span class="abbrev">SHA</span></b></a>] or greater hashing, and allows for
      HMAC [<a href="#RFC2104" title="[RFC2104]"><b><span class="abbrev">RFC2104</span></b></a>], RSA [<a href="#RFC3447" title="[RFC3447]"><b><span class="abbrev">RFC3447</span></b></a>] and ECDSA ???
      algorithms. In the future, additional hashing and encryption algorithms may be added.</p><p>Signatures over sub-graphs are established in a manner such that the signature may be
      included in the graph. The signature covers the entire XDI subgraph rooted in that context
      node at that point in time. In some cases, the signature was made with a key not rooted in the
      graph from which the signature was obtained.</p><p>Recipients of signed XDI messages SHOULD validate all signatures present in the
      response.</p><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e524"></a>4.1 Signature Processing Rules</h3></div></div></div><p></p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e528"></a>4.2 Canonical Representation</h3></div></div></div><p>Signing XDI statements and messages involves first normalizing to the XDI Flat
        Serialization as defined in [<a href="#XDICore" title="[XDICore]"><b><span class="abbrev">XDICore</span></b></a>], and afterwards, incorporation of a
          <em class="glossterm">Signature Block</em> in a manner not disruptive to validators.</p><p>XDI Flat Serialization is the only serialization format used for signature creation and
        validation. Implementations that choose to transfer XDI messages in another serialization
        format MUST serialize the message in XdiFlatSerialization prior to attempting
        validation.</p><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e540"></a>4.2.1 Canonicalization Process</h4></div></div></div><p>The following steps MUST be performed in this order to produce the
            <em class="glossterm">Normalized Graph</em>. These requirements apply to message senders as
          well as message recipients.</p><p>
          </p><div class="orderedlist"><ol type="1"><li><p>Ensure the sub-graph is UTF-8 encoded and formatted as defined in XDI Flat
                Serialization defined in [<a href="#XDICore" title="[XDICore]"><b><span class="abbrev">XDICore</span></b></a>].</p></li><li><p>All unquoted white space and new lines MUST be removed (TODO: better clarify
                white space. should this go into XdiFlatSerialization?)</p></li><li><p>All JSON [<a href="#rfc4627" title="[RFC 4627]"><b><span class="abbrev">RFC 4627</span></b></a>] keys in the unsigned graph MUST be sorted in
                UTF-8 [<a href="#RFC3629" title="[RFC3629]"><b><span class="abbrev">RFC3629</span></b></a>] byte-order.</p></li></ol></div><p>
        </p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="s.alg"></a>4.3 Algorithms</h3></div></div></div><p></p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e571"></a>4.4 Graph Signatures</h3></div></div></div><p></p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e575"></a>4.5 Message Signatures</h3></div></div></div><p></p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="s.encprocess"></a>5 Encryption Processing Rules</h2></div></div></div><p>TODO: encrypt literals, encrypt single statement, encrypt sub graph. how to address hidden
      statements</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="s.seccon"></a>6 Security Considerations</h2></div></div></div><p></p></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="s.biblio"></a>7 Normative References</h2></div></div></div><div class="bibliomixed"><a name="rfc2119"></a><p class="bibliomixed">[<b><span class="abbrev">RFC 2119</span></b>] 
            
            <i>Key words for use in RFCs to Indicate Requirement Levels</i>, <span class="date">March
                1997. </span>
            <span class="author"><span class="firstname">S. </span><span class="surname">Bradner</span></span>. <span class="releaseinfo">IETF (Internet Engineering Task Force) RFC 2119, </span>
            <span class="citetitle"><em class="citetitle"><a href="http://www.ietf.org/rfc/rfc2119.txt" target="_top">http://www.ietf.org/rfc/rfc2119.txt</a></em></span>
        </p></div><div class="bibliomixed"><a name="rfc4627"></a><p class="bibliomixed">[<b><span class="abbrev">RFC 4627</span></b>] 
            
            <i>The application/json Media Type for JavaScript Object Notation (JSON)</i>, <span class="date">July
                2006. </span>
            <span class="author"><span class="firstname">D. </span><span class="surname">Crockford</span></span>. <span class="releaseinfo">IETF (Internet Engineering Task Force) RFC 4627, </span>
            <span class="citetitle"><em class="citetitle"><a href="http://www.ietf.org/rfc/rfc4627.txt" target="_top">http://www.ietf.org/rfc/rfc4627.txt</a></em></span>
        </p></div><div class="bibliomixed"><a name="XDICore"></a><p class="bibliomixed">[<b><span class="abbrev">XDICore</span></b>] 
            
            <i>XDI Core version 1.0</i>, <span class="date">June 2014</span>
            <span class="editor"><span class="firstname">Drummond</span><span class="surname">Reed</span></span>. 
            <span class="publisher"><span class="publishername">OASIS</span></span>
            <span class="releaseinfo"></span>
            <span class="citetitle"><em class="citetitle"><a href="" target="_top"></a>XDICore</em></span>
        </p></div><div class="bibliomixed"><a name="XDIDisco"></a><p class="bibliomixed">[<b><span class="abbrev">XDIDisco</span></b>] 
            
            <i>XDI Discovery version 1.0</i>, <span class="date">June 2014</span>
            <span class="editor"><span class="firstname">Drummond</span><span class="surname">Reed</span></span>. 
            <span class="publisher"><span class="publishername">OASIS</span></span>
            <span class="releaseinfo"></span>
            <span class="citetitle"><em class="citetitle"><a href="" target="_top"></a>XDIDisco</em></span>
        </p></div><div class="bibliomixed"><a name="XDIMsg"></a><p class="bibliomixed">[<b><span class="abbrev">XDIMsg</span></b>] 
            
            <i>XDI Messaging version 1.0</i>, <span class="date">June 2014</span>
            <span class="editor"><span class="firstname">Drummond</span><span class="surname">Reed</span></span>. 
            <span class="publisher"><span class="publishername">OASIS</span></span>
            <span class="releaseinfo"></span>
            <span class="citetitle"><em class="citetitle"><a href="" target="_top"></a>XDIMsg</em></span>
        </p></div><div class="bibliomixed"><a name="XDIPolicy"></a><p class="bibliomixed">[<b><span class="abbrev">XDIPolicy</span></b>] 
            
            <i>XDI Policy version 1.0</i>, <span class="date">June 2014</span>
            <span class="editor"><span class="firstname">Drummond</span><span class="surname">Reed</span></span>. 
            <span class="publisher"><span class="publishername">OASIS</span></span>
            <span class="releaseinfo"></span>
            <span class="citetitle"><em class="citetitle"><a href="" target="_top"></a>XDIPolicy</em></span>
        </p></div><div class="bibliomixed"><a name="XDISec"></a><p class="bibliomixed">[<b><span class="abbrev">XDISec</span></b>] 
            
            <i>XDI Security Mechanisms version 1.0</i>, <span class="date">June 2014</span>
            <span class="editor"><span class="firstname">Peter</span><span class="surname">Davis</span></span>. 
            <span class="publisher"><span class="publishername">OASIS</span></span>
            <span class="releaseinfo"></span>
            <span class="citetitle"><em class="citetitle"><a href="" target="_top"></a>XDISec</em></span>
        </p></div><div class="bibliomixed"><a name="XDIPriv"></a><p class="bibliomixed">[<b><span class="abbrev">XDIPriv</span></b>] 
            
            <i>XDI Privacy version 1.0</i>, <span class="date">June 2014</span>
            <span class="editor"><span class="firstname">Peter</span><span class="surname">Davis</span></span>. 
            <span class="publisher"><span class="publishername">OASIS</span></span>
            <span class="releaseinfo"></span>
            <span class="citetitle"><em class="citetitle"><a href="" target="_top"></a>XDIPriv</em></span>
        </p></div><div class="bibliomixed"><a name="XDIDictionary"></a><p class="bibliomixed">[<b><span class="abbrev">XDIDictionary</span></b>] 
            
            <i>XDI Dictionary version 1.0</i>, <span class="date">June 2014</span>
            <span class="editor"><span class="firstname">Drummond</span><span class="surname">Reed</span></span>. 
            <span class="publisher"><span class="publishername">OASIS</span></span>
            <span class="releaseinfo"></span>
            <span class="citetitle"><em class="citetitle"><a href="" target="_top"></a>XDIDictionary</em></span>
        </p></div><div class="bibliomixed"><a name="XDISig"></a><p class="bibliomixed">[<b><span class="abbrev">XDISig</span></b>] 
            
            <i>XDI Signatures version 1.0</i>, <span class="date">June 2014</span>
            <span class="editor"><span class="firstname">Peter</span><span class="surname">Davis</span></span>. 
            <span class="publisher"><span class="publishername">OASIS</span></span>
            <span class="releaseinfo"></span>
            <span class="citetitle"><em class="citetitle"><a href="" target="_top"></a>XDISig</em></span>
        </p></div><div class="bibliomixed"><a name="RFC3629"></a><p class="bibliomixed">[<b><span class="abbrev">RFC3629</span></b>] 
            
            <i>UTF-8, a transformation format of ISO 10646</i>
            <span class="date">November 2003</span>
            <span class="editor"><span class="firstname">F.</span><span class="surname">Yergeau</span></span>
            <span class="publisher"><span class="publishername">IETF</span></span>
        </p></div><div class="bibliomixed"><a name="RFC2104"></a><p class="bibliomixed">[<b><span class="abbrev">RFC2104</span></b>] 
            
            <i>HMAC: Keyed-Hashing for Message Authentication</i>
            <span class="date">February 1997</span>
            <span class="editor"><span class="firstname">H.</span><span class="surname">Krawczyk</span></span>
            <span class="editor"><span class="firstname">M.</span><span class="surname">Bellare</span></span>
            <span class="editor"><span class="firstname">R.</span><span class="surname">Canetti</span></span>
            <span class="publisher"><span class="publishername">IETF (Internet Engineering Task Force)</span></span>
        </p></div><div class="bibliomixed"><a name="RFC7159"></a><p class="bibliomixed">[<b><span class="abbrev">RFC7159</span></b>] 
            
            <i>The JavaScript Object Notation (JSON) Data Interchange Format</i>
            <span class="date">March 2014</span>
            <span class="editor"><span class="firstname">T.</span><span class="surname">Bray</span></span>
            <span class="citetitle"><em class="citetitle"><a href="http://tools.ietf.org/rfc/rfc7159.txt" target="_top">http://tools.ietf.org/rfc/rfc7159.txt</a></em></span>
            <span class="publisher"><span class="publishername">IETF (Internet Engineering Task Force)</span></span>
        </p></div><div class="bibliomixed"><a name="RFC3447"></a><p class="bibliomixed">[<b><span class="abbrev">RFC3447</span></b>] 
            
            <i>Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography
                Specifications Version 2.1</i>
            <span class="date">February 2003</span>
            <span class="editor"><span class="firstname">J.</span><span class="surname">Jonsson</span></span>
            <span class="editor"><span class="firstname">B.</span><span class="surname">Kaliski</span></span>
            <span class="publisher"><span class="publishername">IETF</span></span>
        </p></div><div class="bibliomixed"><a name="SHA"></a><p class="bibliomixed">[<b><span class="abbrev">SHA</span></b>] 
            
            <i>Secure Hash Standard</i>
            <span class="productnumber">NIST FIPS PUB 180-4</span>
            <span class="date">March 2012</span>
            <span class="editor"><span class="firstname">F.</span><span class="surname">Yergeau</span></span>
            <span class="publisher"><span class="publishername">National
                    Institute of Standards and Technology, U.S. Department of
                    Commerce</span></span>
        </p></div></div><div class="appendix" lang="en"><h2 class="title" style="clear: both"><a name="s.examples"></a>Appendix A Examples</h2><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e1007"></a>A.1 Graph Signature Examples</h3></div></div></div><p></p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e1011"></a>A.2 Message Signature Examples</h3></div></div></div><p></p></div></div><div class="appendix" lang="en"><h2 class="title" style="clear: both"><a name="s.revhist"></a>Appendix B Revision History</h2><p>
      </p><div class="revhistory"><table border="1" width="100%" summary="Revision history"><tr><td align="left">Revision wd1</td><td align="left">23 May 2014</td><td align="left">pcd</td></tr><tr><td align="left" colspan="3">Initial draft incorporating general outline, and initial proposed signing
            processing rules.</td></tr><tr><td align="left">Revision wd1</td><td align="left">29 May</td><td align="left">pcd</td></tr><tr><td align="left" colspan="3">Reorganization to allow the document to describe gerneralized cryptographic
            operations. Added distinct metadata sections for keys, signatures and
            encryption.</td></tr></table></div><p>
    </p></div></div><table style="font-size:80%" width="100%"><tr><td>xdi-signatures-1.0-wd01<br>Standards Track Work Product</td><td style="text-align:center"><br>Copyright &copy; OASIS 2014. All rights reserved.</td><td style="text-align:right">23 May 2014</td></tr></table></body></html>