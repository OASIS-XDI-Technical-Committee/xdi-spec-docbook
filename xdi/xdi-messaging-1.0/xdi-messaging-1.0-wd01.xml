<?xml version="1.0" encoding="UTF-8"?>
<!-- 
For use when a committee document points at the OASIS web site for publishing:
<?xml-stylesheet type="text/xsl" 
href="http://docs.oasis-open.org/templates/DocBook/spec-0.6/stylesheets/oasis-specification-html.xsl"?>
<!DOCTYPE article
  PUBLIC "-//OASIS//DTD DocBook XML V4.4//EN"
         "http://www.oasis-open.org/docbook/xml/4.4/docbookx.dtd" 

For use when a committee document points to an embedded runtime installation:
<?xml-stylesheet type="text/xsl" 
         href="htmlruntime/spec-0.6/stylesheets/oasis-specification-html.xsl"?>
<!DOCTYPE article
 PUBLIC "-//OASIS//DTD DocBook XML V4.4//EN" 
        "htmlruntime/spec-0.6/docbook/docbookx.dtd" 

For use when a committee document is published in a local environment only
(note the instructions for local publishing require adjusting the stylesheet
 and DocBook directories in these declarations):
<?xml-stylesheet type="text/xsl" 
href="file:///c:/oasis/spec-0.6/stylesheets/oasis-specification-html-offline.xsl"?>
<!DOCTYPE article
  PUBLIC "-//OASIS//DTD DocBook XML V4.4//EN"
         "file:///c:/oasis/spec-0.6/docbook/docbookx.dtd" 
-->
<?xml-stylesheet type="text/xsl" 
href="http://xdi.org/xdi-spec-docbook/htmlruntime/spec-0.6/stylesheets/oasis-specification-html.xsl"?>
<!DOCTYPE article
  PUBLIC "-//OASIS//DTD DocBook XML V4.4//EN"
         "http://www.oasis-open.org/docbook/xml/4.4/docbookx.dtd" 
[
<!--the document properties-->
<!ENTITY name "xdi-messaging">
<!ENTITY pversion "0.1">
<!ENTITY version "1.0">
<!ENTITY stage "wd01">
<!ENTITY standard "Working Draft 01">
<!ENTITY this-loc "http://docs.oasis-open.org/xdi/spec-&version;">
<!ENTITY previous-loc "http://docs.oasis-open.org/xdi/spec-&pversion;">
<!ENTITY latest-loc "http://docs.oasis-open.org/xdi/spec">
<!ENTITY pubdate "25 September 2013">
<!ENTITY title "XDI Messaging V&version;">
]>
<article status="&standard;">

<articleinfo>
<title>&title;</title>

<!--releaseinfo role="cvs">
$Id: oasis-specification-0.6-wd04.xml,v 1.2 2012/06/14 01:57:23 admin Exp $
</releaseinfo-->

<productname>&name;</productname>
<productnumber>&version;-&stage;</productnumber>
<releaseinfo role="track">Standards Track Work Product</releaseinfo>

<releaseinfo role="OASIS-specification-this-authoritative">&this-loc;/&name;-&version;-&stage;.xml</releaseinfo>
<releaseinfo role="OASIS-specification-this">&this-loc;/&name;-&version;-&stage;.pdf</releaseinfo>
<releaseinfo role="OASIS-specification-this">&this-loc;/&name;-&version;-&stage;.html</releaseinfo>

<releaseinfo role="OASIS-specification-previous-authoritative">&previous-loc;/&name;-&pversion;.xml</releaseinfo>
<releaseinfo role="OASIS-specification-previous">&previous-loc;/&name;-&pversion;.pdf</releaseinfo>
<releaseinfo role="OASIS-specification-previous">&previous-loc;/&name;-&pversion;.html</releaseinfo>

<releaseinfo role="OASIS-specification-latest-authoritative">&latest-loc;/&name;.xml</releaseinfo>
<releaseinfo role="OASIS-specification-latest">&latest-loc;/&name;.pdf</releaseinfo>
<releaseinfo role="OASIS-specification-latest">&latest-loc;/&name;.html</releaseinfo>

<releaseinfo role="committee"><ulink url="http://www.oasis-open.org/committees/xdi">OASIS XDI TC</ulink></releaseinfo>

<authorgroup>
<editor>
  <firstname>Markus</firstname><surname>Sabadello</surname>
  <affiliation>
    <orgname>Project Danube</orgname>
  </affiliation>
  <email>sabadello@projectdanube.org</email>
</editor>
  <editor>
    <firstname>Drummond</firstname><surname>Reed</surname>
    <affiliation>
      <orgname>Respect Network</orgname>
    </affiliation>
    <email>drummond@respectnetwork.net</email>
  </editor>
  <editor>
    <firstname>Joseph</firstname><surname>Boyle</surname>
    <affiliation>
      <orgname>XDI.org</orgname>
    </affiliation>
    <email>firstname at orgname</email>
  </editor>
</authorgroup>

<pubdate>&pubdate;</pubdate>

<copyright><year>2013</year>
<holder>OASIS Open, Inc. All Rights Reserved.</holder></copyright>

<legalnotice role="additional"><title>Additional artifacts</title>
<para>This prose specification is one component of a Work Product which also includes:</para>
<itemizedlist spacing="compact">
<listitem><para>
publishing materials: <ulink url="&this-loc;/&name;-&version;-&stage;.zip">&this-loc;/&name;-&version;-&stage;.zip</ulink></para>
</listitem>
</itemizedlist>
</legalnotice>

<legalnotice role="related"><title>Related work</title>
  <para>This document is primarily based on a set of proposals that had been collected by the OASIS XDI TC on its associated wiki at <ulink url="https://wiki.oasis-open.org/xdi/">https://wiki.oasis-open.org/xdi/</ulink>.</para>
</legalnotice>

<abstract><title>Abstract</title>
  <para>This working draft specifies the abstract pattern for all XDI messaging together with the binding to the http/https protocol for performing XDI operations using XDI messages.</para>
</abstract>

<legalnotice role="status"><title>Status</title>
<para>This is a work in progress contributed to the OASIS TC administration 
and does not at this time represent the consensus of any particular OASIS Technical Committee.
There are no plans to make this a formal Committee Specification as it is merely an internal
document made available to committee members to support the publishing process.</para>
</legalnotice>

<legalnotice role="citation"><title>Citation format</title>
<para>When referencing this specification the following citation format should be used:</para>

<bibliolist>

<bibliomixed>
  <abbrev>OASIS-XDI-MESSAGING-V1.0</abbrev>
  <title>OASIS XDI MESSAGING V1.0</title>
  <date>&pubdate;. </date>
  <releaseinfo>OASIS &standard;. </releaseinfo>
  <citetitle><ulink url="&latest-loc;/&name;.html">&latest-loc;/&name;.html</ulink>.</citetitle>
</bibliomixed>

</bibliolist>

</legalnotice>
<legalnotice role="notices"><title>Notices</title>
<para>Copyright &#169; OASIS&#174; Open 2013. All Rights Reserved. 
</para>
<para>All capitalized terms in the following text have the meanings assigned to them in the OASIS Intellectual Property Rights Policy (the "OASIS IPR Policy"). The full Policy may be found at <ulink  url="http://www.oasis-open.org/who/intellectualproperty.php">http://www.oasis-open.org/who/intellectualproperty.php</ulink>.</para>
<para>This document and translations of it may be copied and furnished to others, and derivative works that comment on or otherwise explain it or assist in its implementation may be prepared, copied, published, and distributed, in whole or in part, without restriction of any kind, provided that the above copyright notice and this section are included on all such copies and derivative works. However, this document itself may not be modified in any way, including by removing the copyright notice or references to OASIS, except as needed for the purpose of developing any document or deliverable produced by an OASIS Technical Committee (in which case the rules applicable to copyrights, as set forth in the OASIS IPR Policy, must be followed) or as required to translate it into languages other than English.</para> 
<para>The limited permissions granted above are perpetual and will not be revoked by OASIS or its successors or assigns.</para>
<para>This document and the information contained herein is provided on an "AS IS" basis and OASIS DISCLAIMS ALL WARRANTIES, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY OWNERSHIP RIGHTS OR ANY IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.</para> 
<para>OASIS requests that any OASIS Party or any other party that believes it has patent claims that would necessarily be infringed by implementations of this OASIS Committee Specification or OASIS Standard, to notify OASIS TC Administrator and provide an indication of its willingness to grant patent licenses to such patent claims in a manner consistent with the IPR Mode of the OASIS Technical Committee that produced this specification.</para>
<para>OASIS invites any party to contact the OASIS TC Administrator if it is aware of a claim of ownership of any patent claims that would necessarily be infringed by implementations of this specification by a patent holder that is not willing to provide a license to such patent claims in a manner consistent with the IPR Mode of the OASIS Technical Committee that produced this specification. OASIS may include such claims on its website, but disclaims any obligation to do so.</para>
<para>OASIS takes no position regarding the validity or scope of any intellectual property or other rights that might be claimed to pertain to the implementation or use of the technology described in this document or the extent to which any license under such rights might or might not be available; neither does it represent that it has made any effort to identify any such rights. Information on OASIS' procedures with respect to rights in any document or deliverable produced by an OASIS Technical Committee can be found on the OASIS website. Copies of claims of rights made available for publication and any assurances of licenses to be made available, or the result of an attempt made to obtain a general license or permission for the use of such proprietary rights by implementers or users of this OASIS Committee Specification or OASIS Standard, can be obtained from the OASIS TC Administrator. OASIS makes no representation that any information or list of intellectual property rights will at any time be complete, or that any claims in such list are, in fact, Essential Claims.</para>
<para>The name "OASIS" is a trademark of <ulink url="http://www.oasis-open.org">OASIS</ulink>, the owner and developer of this specification, and should be used only to refer to the organization and its official outputs. OASIS welcomes reference to, and implementation and use of, specifications, while reserving the right to enforce its marks against misleading uses. Please see <ulink url="http://www.oasis-open.org/who/trademark.php">http://www.oasis-open.org/who/trademark.php</ulink> for above guidance.</para>
</legalnotice>
</articleinfo>

<section id="s.introduction">
<title>Introduction</title>

<para>
This working draft specifies the abstract pattern for all XDI messaging together with the binding to the http/https protocol for performing XDI operations using XDI messages..</para>

<para>
This working draft builds on <xref linkend="xdi-core-1.0"/>.</para>

<section>
  <title>Terminology</title>
  <section>
    <title> Key words</title>
    <para>The key words <glossterm>must</glossterm>, <glossterm>must
      not</glossterm>, <glossterm>required</glossterm>,
      <glossterm>shall</glossterm>, <glossterm>shall not</glossterm>,
      <glossterm>should</glossterm>, <glossterm>should not</glossterm>,
      <glossterm>recommended</glossterm>, <glossterm>may</glossterm>, and
      <glossterm>optional</glossterm> are to be
      interpreted as described in <xref linkend="rfc2119"/>. Note that for
      reasons of style, these words are not capitalized in this
      document.</para>
  </section>
</section>

<section>
  <title>Normative References</title>
  <bibliolist>
    <bibliomixed id="xdi-core-1.0">
      <abbrev>xdi-core-1.0</abbrev>
      OASIS Committee Working Draft 01
      <title><ulink url="../xdi-core-1.0/xdi-core-1.0-wd01.xml">XDI 1.0 Core Specification</ulink></title>,
      OASIS &pubdate;, 
    </bibliomixed>
    <bibliomixed id="rfc2119">
      <abbrev>RFC 2119</abbrev>
      <title>Key words for use in RFCs to Indicate Requirement Levels</title>, 
      <date>March 1997. </date>
      <author><firstname>S. </firstname><surname>Bradner</surname></author>.
      <releaseinfo>IETF (Internet Engineering Task Force) RFC 2119, </releaseinfo>
      <citetitle><ulink url="http://www.ietf.org/rfc/rfc2119.txt">http://www.ietf.org/rfc/rfc2119.txt</ulink></citetitle>
    </bibliomixed>
  </bibliolist>
</section>

<section>
  <title>Non-Normative References</title>
  <bibliolist>
    <bibliomixed id="json-ld">
      <abbrev>json-ld</abbrev>
      W3C Editor's Draft 20 August 2013,
      <title><ulink url="http://json-ld.org/spec/latest/json-ld">JSON-LD: A JSON-based Serialization for Linked Data</ulink></title>
      , W3C 20 August 2013 
    </bibliomixed>
  </bibliolist>
</section>

</section>

<section>
  <title>XDI Messaging</title>
  
  <para>XDI Messaging provides a mechanism for interacting with XDI graphs. In the context of XDI Messaging,
  the XDI graph one interacts with is called the "target graph". The interactions with the target graph are represented
  as a "message", which is itself an XDI graph. Given a message and a target graph, the message can be "applied"
  to the target graph, which can result in one, or both, of the following:</para>
  <ul>
    <li>A modification of the target graph</li>
    <li>A "message result", which is itself an XDI graph</li>
  </ul>
  <para>In order to apply a message to a target graph, an XDI processor is required that performs the XDI Messaging
  logic. This can be done either locally with the help of a software library that acts as the XDI processor, or it can
  be done through a transport binding. In the case of a transport binding, a protocol such as HTTP is used for transporting
  messages and message results over a network.</para>
  <para>Transport bindings may be based on a client/server model or on other network topologies. They may be
  synchronous or asynchronous. The XDI Messaging concepts of "target graph", "message", "message result", as well as
  the logic performed by the XDI processor, remain constant and independent of a transport binding.</para>
</section>

<section>
  <title>XDI Message Structure</title>
  
  <para>Describe here the structure of XDI messages.</para>

  <section>
    <title>Message Envelopes</title>
    
    <para>Describe here Message Envelopes</para>
  </section>
  
  <section>
    <title>Messages</title>
    
    <para>Describe here Messages</para>
  </section>
  
  <section>
    <title>Operations</title>
    
    <para>Operations express the actual interactions to be applied to the target graph. Three core operations ($get, $set, $del)
    are defined for reading, writing, and deleting data in the target graph. A fourth operation ($do) is defined for extensible,
    custom interactions with the target graph. Within the message, operations are represented as XDI relational arcs.</para>
  </section>
  
  <section>
    <title>Target Addresses and Target Statements</title>
    
    <para>Every operation has a target to which the interaction applies. An operation's target hereby corresponds to the
    target context of the XDI relational arc that represents the operation:</para>
	  <ul>
      <li>If the target context is an XDI inner graph, then all non-implied statements in that XDI inner graphs are "target statements"
      of the operation.</li>
      <li>If the target context is not an XDI inner graph, then the address of the target context is the "target address" of the
      operation.</li>
    </ul>
    </section>
</section>

<section>
  <title>XDI Message Envelope Processing</title>
  
  <para></para>
</section>

<section>
  <title>XDI Message Processing</title>
  
  <section>
    <title>Message ID</title>
    
    <para>Describe here Message ID</para>
  </section>
  
  <section>
    <title>Message Timestamp</title>
    
    <para>Describe here Message Timestamp</para>
  </section>
  
  <section>
    <title>Sending Peer</title>
    
    <para>Describe here Sending Peer</para>
  </section>
  
  <section>
    <title>Receiving Peer</title>
    
    <para>Describe here Receiving Peer</para>
  </section>
  
  <section>
    <title>Link Contract</title>
    
    <para>Every message MUST contain a reference to an XDI link contract for authorizing the message. This
    reference is represented as an XDI $do relational arc on the message. The target context of this relational
    arc is the address of the XDI link contract in the target graph.</para>
    <para>If no XDI link contract exists at the given address in the target graph, the message fails, and
    the XDI processor raises an error.</para>
    <para>If the XDI link contract in the target graph contains an XDI policy, the XDI processor evaluates the
    XDI policy before applying the message's opertions to the target graph. If the XDI policy evaluates to false,
    the message fails, and the XDI processor raises an error.</para>
    <para>If the message contains an operation which is not permitted by the XDI link contract, the operation fails,
    and the XDI processor raises and error (TODO: what if some but not all of the operations are permitted?)</para>
  </section>
  
  <section>
    <title>Message Policy</title>
    
    <para>A message MAY contain an XDI message policy for conditional application of the message. This XDI
    message policy is represented as an XDI $if sub-context of the message.</para>
    <para>The XDI processor evaluates the XDI policy before applying the message's opertions to the 
    target graph. If the XDI message policy evaluates to false, the message fails, and the XDI processor raises
    an error.</para>
  </section>
  
  <section>
    <title>Message Parameters</title>
    
    <para>Describe here Message Parameters</para>
  </section>
  
  <section>
    <title>Message Authentication</title>
    
    <para>Describe here Message Authentication</para>
  </section>
</section>

<section>
  <title>XDI Operation Processing</title>
  
  
  
  <section>
    <title>$get</title>
    
    <para>Describe here $get</para>
  </section>
  
  <section>
    <title>$set</title>
    
    <para>Describe here $set</para>
  </section>
  
  <section>
    <title>$del</title>
    
    <para>Describe here $del</para>
  </section>
  
  <section>
    <title>$do</title>
    
    <para>Describe here $do</para>
  </section>
</section>
  
<section>
  <title>Error Handling</title>

  <para>Describe here Error Handling</para>
</section>

<section>
  <title>Transactional Integrity</title>
  
  <para>Describe here Transactional Integrity</para>
</section>
  
<section>
  <title>HTTP/HTTPS Transport</title>

  <section>
    <title>HTTP Request</title>
    
    <para>Describe here HTTP Request</para>
  </section>

  <section>
    <title>HTTP Response</title>
    
    <para>Describe here HTTP Response</para>
  </section>
</section>

<appendix id="a.acknowledgments" role="non-normative">
  <title>Acknowledgments</title>

  <para>This specification was written with the generous and appreciated assistance of XXXXX. We also acknowledge the following original members of the XDI TC: YYYYY</para>
</appendix>
  
<appendix id="a.dollarwords" role="non-normative">
  <title>Dollar Words</title>
  
  <para>This appendix contains formal definitions of the XDI dollar words introduced by this specification.</para>
</appendix>
  
<appendix id="a.examples" role="non-normative">
  <title>Examples</title>
  
  <para>This appendix contains XDI messaging examples.</para>
</appendix>

</article>
